<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">










<html>
  <head>
    <title>hk2 - Introduction to Configuration</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
          <meta name="author" content="Jerome Dochez" />
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      </head>
  <body class="composite">
    <!-- TODO: move this into JavaScript to patch the skin
      <div class="xright">  </div>
    -->
    <div id="bodyColumn">
      <div id="contentBox">
        <p>Most server side software store configuration in xml file, and naturally HK2 offers such support out of the box. However, extensions hooks are provided to save configuration to other means that an xml file as the configuration structure definition is agnostic of the underlying persistence model. For that particular reasons, it was not practical to define our configuration mappings using a technology like JAXB due to its attachement to the xml format. </p><p>However, the description of such mappings ressembles the JAXB interfaces definition.</p><div class="section"><h2>Mapping<a name="Mapping"></a></h2><p>The mapping from Java to a persisted configuration is using a tree of plain old Java interfaces definitions that reprensent the document structure. Each tree node can have attributes which can only be a String or a type that maps directly to a String (with a toString() method and a String parameter based constructor), and can have sub-elements which are tree nodes themselves. Such elements can have various cardinality, like 0|1, 1, 1..n, 0..n. </p><div class="section"><h3>@Configured<a name="aConfigured"></a></h3><p>Any interface defining a configuration mapping must be annotated with <a href="#configapidocsorgjvnethk2configConfigured.html">Configured</a> so the necessary metadata be generated by the HK2 APT plugin. </p><div class="source"><pre>        @Configured
        public interface HttpServer extends ConfigBeanProxy {
                // mappings for the http-server element defined here
        }

        will result in the following xml snippet :
        &lt;....&gt;
                &lt;http-server ... /&gt;
        &lt;/...&gt;</pre></div><div class="section"><h4>Attributes<a name="Attributes"></a></h4><p>Attributes are represented in the configuration definition with the <a href="#configapidocsorgjvnethk2configAttribute.html">Attribute</a> annotation. </p><div class="source"><pre>        @Configured
        public interface HttpServer extends ConfigBeanProxy {

                @Attribute
                String getName();
                void setName(String name);

        }

        will result in the following xml snippet :

        &lt;....&gt;
                &lt;http-server name=&quot;...&quot; ... /&gt;
        &lt;/...&gt;
</pre></div></div><div class="section"><h4>Elements<a name="Elements"></a></h4><p>Sub elements of a configuration node are represented in the configuration definition with <a href="#configapidocsorgjvnethk2configElement.html">Element</a> annotation.</p><div class="source"><pre>
        Let's imagine another configuration mapping : 

        @Configured 
        public interface HttpListener extends ConfigBeanProxy {
                @Attribute
                String getName();
        }

        now our example can be enhanced with : 
        
        @Configured
        public interface HttpServer extends ConfigBeanProxy {

                @Attribute
                String getName();
                void setName(String name);

                @Element
                HttpListener getHttpListener();
                void setHttpListener(HttpListener listener);
        }

        will result in the following xml snippet :

        &lt;....&gt;
                &lt;http-server name=&quot;...&quot; ... &gt;
                        \&lt;http-listener name=&quot;...&quot; .../&gt;
                &lt;/http-server-name&gt;
        &lt;/...&gt;
        </pre></div></div></div></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">&#169;  
          2010
    
          Sun Microsystems, Inc.
          
  

  
  
  &nbsp;| Last Published: 09/22/2010
  &nbsp;| Version: 1.0.48-SNAPSHOT
</div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
